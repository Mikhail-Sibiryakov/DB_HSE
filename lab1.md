### Блок 1
2. Найдите все рейсы прибившие в SVO в интервале с 16:00 до 19:00 2017-07-22

Выбираем все строки таблицы с условием, что аэропорт прибытия SVO и что реальное прибытие должно быть в заданном диапазоне. Проверка status = 'Arrived' не является обязательной, так как если статус иной, то во времени реально прибытия в таблице стоит null.

```sql
SELECT
    *
FROM
    flights
WHERE
    arrival_airport = 'SVO'
    AND actual_arrival >= '2017-07-22 16:00:00+03'
    AND actual_arrival <= '2017-07-22 19:00:00+03'
    AND status = 'Arrived';
```

### Блок 2
1. Cдвиньте время вылета всех рейсов вылетающих ночью с 2017-09-11/2017-09-12 (вылетающих между 23:00 и 06:00) на 30 минут позже.

В бд есть constraint flights_check CHECK ((scheduled_arrival > scheduled_departure)), поэтому логично сдвигать сразу и время отправления, и время прибытия на одно и то же значение (иначе, на самом деле, запрос не будет выполнен корректно, так как будет нарушено данное ограничение).
Просто обновление нужной таблицы, явно указывает сдвиг для двух колонок, которые подходят под условие (интервал отправления).

```sql
UPDATE flights
SET
    scheduled_departure = scheduled_departure + INTERVAL '30 minutes',
    scheduled_arrival = scheduled_arrival + INTERVAL '30 minutes'
WHERE
    scheduled_departure >= '2017-09-11 23:00:00'
    AND scheduled_departure <= '2017-09-12 06:00:00';
```

### Блок 3
3. Для каждой timezone найдите широту самого северный аэропорт.

В бд coordinates имеет тип данных point то есть представленно в виде (широта, долгота) - нам нужно второе значение кортежа, то есть первое в нуль-индексации. Чтобы в итоговой выборке оно подписывалось не как "MAX", а по-нормальному, то пишем "AS northernmost_latitude". Группируем по timezone, так как нужно найти свой максимум долготы для каждой временной зоны.

```sql
SELECT
    timezone,
    MAX(coordinates[1]) AS northernmost_latitude
FROM
    airports_data
GROUP BY
    timezone;
```